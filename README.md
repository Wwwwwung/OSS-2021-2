# 글꼴 분석을 통한 DB구축과 글꼴 추천 시스템

디지털 시대에 미디어 콘텐츠의 중요성이 대두되며 콘텐츠의 경쟁력을 높여줄 글꼴의 영향력 또한 높아지고 있다. 하지만 글꼴은 저작권 보호를 받는 저작물로 글꼴 저작권을 침해한 자는 저작권법 제136조 제1항에 따라 5년 이하의 징역 또는 5000만 원 이하의 벌금에 처할 수 있다. 한국저작권위원회에 따르면 2019년 글꼴 파일 저작권 상담이 3,886건으로 글꼴과 관련하여 상당히 많은 분쟁이 일어나는 것을 알 수 있다. 

> >"본인은 폰트 한두 개만 사용했는데 저작권자는 패키지 전체를 다 사야만 합의해 준다는 조건으로 합의를 종용하는 경우도 적지 않다. 적게는 수십만원, 많게는 수백만원까지 요구하는 것으로 안다."

하지만 글꼴은 종류도 다양하고 개인부터 기업까지 제작 업체도 달라서 저작권에 대한 전문지식이 없는 경우 어떤 것이 저작권 침해에 해당하는지조차 알기 어려운 실정이다. 글꼴의 정보가 정확하게 알려지지 않아 일반 사용자는 글꼴의 저작권 관련 내용을 차는 것도 어렵다. 또한 사용자가 마음에 드는 글꼴을 찾았다 할지라도 사용자의 의도에 따라 사용할 수 없으면 다시 글꼴을 찾는 힘들 들여야 하며 비슷한 글꼴을 다시 찾는 일도 쉽지 않다.

* * *
따라서 이런 문제를 해결하기 위해 한글 글꼴을 분석하여 데이터베이스를 구축하고, 사용자가 사용할 글꼴 파일을 입력하면 사용 범위와 가격 등 글꼴 정보를 볼 수 있도록 한다. 또한 사용자가 등록한 글꼴 파일과 비슷한 글꼴을 추천하여 일반 사용자가 글꼴에 쉽게 접근할 수 있도록 하는 시스템을 제안한다.

## DB 구축하기

글꼴 분석을 위해서는 글꼴의 데이터베이스를 구축하는 일이 선행 되어야 한다. 글꼴의 DB를 구축할 때에는 글꼴을 분류, 검색을 위해 특징 추출을 해야한다.
해당 글꼴로 만들 수 있는 모든 글자에서 특징을 추출하면 정확도가 높은 DB를 만들 수 있지만 위치에 따라 글꼴 모양이 달라지지 않는 영어나 숫자와 다르게, 한글 글꼴은 2,350자를 분석해야 모든 정보를 알 수 있다. 따라서 다음 기준에 따라 대표 글꼴을 선정하여 글꼴 분석에 할애하는 시간을 단축한다.

> 1. 대부분의 한글 요소를 포함한다.
> 1. 형태 변별 요소가 많은 글자를 대표 글꼴로 선정한다.
> 1. 단순한 자소 모음을 가지는 글자를 기본으로 선정하여 파생한다.

각 글꼴에서 대표 글꼴 영상을 렌더링하여 특징을 추출하면 노이즈나 왜곡이 발생하지 않아 특징 추출에 용의하다. 렌더링 한 영상에서 특징을 추출하는 기술로는 **HOG(Histogram of Oriented Gradients)** 를 사용한다. HOG는 대상 영역을 일정 크기의 셀로 분할하고 셀마다 edge 픽셀들의 방향에 대한 히스토그램을 구하고 이들 값을 일렬로 연결한 벡터값으로, edge의 방향 히스토그램이라 할 수 있다. 이 기술을 사용해 고유한 윤곽선 정보를 갖는 글꼴의 특징을 추출할 수 있다.

특징을 추출한 파일을 글꼴 DB에 저장할 때 파일 이름, 글꼴 이름을 저장하고 해당 글꼴의 저작권 관련 사항과 같은 정보를 함께 출력할 수 있도록 글꼴 정보도 함께 저장한다.

* * *
이 과정을 순서도로 나타내면 다음과 같다.

<img src="https://user-images.githubusercontent.com/90589294/139540188-d745bb53-42be-4ad6-a94d-6303ae10bb2c.jpg" width="70%" height="70%"></img>

## 군집화
사용자가 등록한 글꼴 파일과 비슷한 글꼴을 추천하기 위해서는 DB의 데이터들을 일정한 기준으로 분류해야 한다. 데이터를 분류하는 기술로는 **계층적 군집화(Hierarchical Clustering)** 를 사용한다. 계층적 군집화는 계층적 트리 모형을 이용해 개별 개체들을 순차적, 계층적으로 유사한 개체로 통합하여 군집화를 수행하는 알고리즘이다. 이 기술을 수행하려면 모든 개체 간의 거리와 유사도가 필요하다. 따라서 두 관측치 사이의 최단거리를 계산하는 **유클리디안 거리(Euclidian Distance)** 로 거리를 계산하고, 두 벡터의 상관계수를 계산하는 **피어슨 유사도(Pearson Similarity)** 로 유사도를 계산한다. 계층적 군집화를 수행하고 결과를 시각화하는 **덴드로그램(Dendrogram)** 을 생성하여 하나의 군집에 1~7개의 개체가 포함되도록 트리를 잘라 전체 데이터를 군집으로 나눈다. 이렇게 나눈 군집을 통해 사용자가 등록한 글꼴이 포함된 군집을 출력하여 사용자에게 비슷한 글꼴을 추천할 수 있다.

[계층적 군집화 추가 설명](https://ratsgo.github.io/machine%20learning/2017/04/18/HC/)
* * *
이 과정을 순서도로 나타내면 다음과 같다.

<img src="https://user-images.githubusercontent.com/90589294/139540533-8d75be01-848a-4686-8db2-c0c874f8be77.jpg" width="70%" height="70%"></img>

## 사용자 글꼴 검색

위의 과정을 수행하고 나면 글꼴 DB와 데이터 군집화까지 사용자가 글꼴 파일을 입력하기까지 선행되어야 할 것들은 완성되었다. 사용자가 정보를 알고싶은 글꼴 파일을 입력하면 다음과 같은 순서로 글꼴 검색이 수행된다. 

> 1. 대표 글꼴 영상 랜더링
> 1. 영상의 특징 추출 (HOG 적용)
> 1. DB의 기존 데이터와 특징 비교
> 1. 데이터 출력 (파일 이름, 글꼴 이름, 글꼴 정보)
> 1. 데이터의 군집 위치 확인
> 1. 해당 데이터 군집 출력 (최대 6개)

이 과정을 수행하면 사용자가 입력한 글꼴 파일과 같은 특징을 가진 데이터를 찾고 파일 이름, 글꼴 이름, 글꼴 정보를 출력한다. 이후 해당 데이터의 군집 위치를 확인하여 같은 군집에 있는 다른 글꼴의 데이터를 출력해 비슷한 특징을 가진 글꼴 추천을 출력한다.

* * *
이 과정을 순서도로 나타내면 다음과 같다.
<img src="https://user-images.githubusercontent.com/90589294/139540839-ef56b183-5ae9-4ae9-b22c-dc7ce1a6aab3.jpg" width="70%" height="70%"></img>

